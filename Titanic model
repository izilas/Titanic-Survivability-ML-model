{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "188707aa",
   "metadata": {
    "_cell_guid": "b1076dfc-b9ad-4769-8c92-a6c4dae69d19",
    "_uuid": "8f2839f25d086af736a60e9eeb907d3b93b6e0e5",
    "execution": {
     "iopub.execute_input": "2026-01-22T17:06:16.609180Z",
     "iopub.status.busy": "2026-01-22T17:06:16.608812Z",
     "iopub.status.idle": "2026-01-22T17:06:17.971040Z",
     "shell.execute_reply": "2026-01-22T17:06:17.969647Z"
    },
    "papermill": {
     "duration": 1.368967,
     "end_time": "2026-01-22T17:06:17.973091",
     "exception": false,
     "start_time": "2026-01-22T17:06:16.604124",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "/kaggle/input/c/titanic/train.csv\n",
      "/kaggle/input/c/titanic/test.csv\n",
      "/kaggle/input/c/titanic/gender_submission.csv\n"
     ]
    }
   ],
   "source": [
    "# This Python 3 environment comes with many helpful analytics libraries installed\n",
    "# It is defined by the kaggle/python Docker image: https://github.com/kaggle/docker-python\n",
    "# For example, here's several helpful packages to load\n",
    "\n",
    "import numpy as np # linear algebra\n",
    "import pandas as pd # data processing, CSV file I/O (e.g. pd.read_csv)\n",
    "\n",
    "# Input data files are available in the read-only \"../input/\" directory\n",
    "# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n",
    "\n",
    "import os\n",
    "for dirname, _, filenames in os.walk('/kaggle/input'):\n",
    "    for filename in filenames:\n",
    "        print(os.path.join(dirname, filename))\n",
    "\n",
    "# You can write up to 20GB to the current directory (/kaggle/working/) that gets preserved as output when you create a version using \"Save & Run All\" \n",
    "# You can also write temporary files to /kaggle/temp/, but they won't be saved outside of the current session"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a885b00b",
   "metadata": {
    "papermill": {
     "duration": 0.002274,
     "end_time": "2026-01-22T17:06:17.977691",
     "exception": false,
     "start_time": "2026-01-22T17:06:17.975417",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "54502c5c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-22T17:06:17.984214Z",
     "iopub.status.busy": "2026-01-22T17:06:17.983385Z",
     "iopub.status.idle": "2026-01-22T17:06:21.752834Z",
     "shell.execute_reply": "2026-01-22T17:06:21.751618Z"
    },
    "papermill": {
     "duration": 3.775545,
     "end_time": "2026-01-22T17:06:21.755325",
     "exception": false,
     "start_time": "2026-01-22T17:06:17.979780",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Categorical columns that will be one-hot encoded: ['Embarked', 'Sex']\n",
      "\n",
      "Categorical columns that will be dropped from the dataset: ['Cabin']\n",
      "MAE from Approach 3 (One-Hot Encoding):\n",
      "0.22307262569832403\n",
      "495    0\n",
      "648    0\n",
      "278    0\n",
      "31     1\n",
      "255    1\n",
      "      ..\n",
      "780    1\n",
      "837    0\n",
      "215    1\n",
      "833    0\n",
      "372    0\n",
      "Name: Survived, Length: 179, dtype: int64 [0.5  0.   0.25 0.81 0.1  0.04 1.   1.   0.52 0.71 0.01 0.58 0.   1.\n",
      " 1.   0.94 0.01 0.07 0.02 0.9  0.15 1.   0.01 0.08 0.34 1.   0.5  0.82\n",
      " 0.91 0.28 0.25 0.91 0.23 0.1  0.23 0.71 0.13 0.13 0.13 0.12 0.13 0.23\n",
      " 0.05 0.14 1.   0.1  0.   1.   0.   0.07 0.15 0.11 1.   0.07 0.25 0.26\n",
      " 0.12 0.01 0.14 0.02 0.19 0.48 1.   0.08 0.68 0.26 0.97 0.13 0.9  0.97\n",
      " 0.99 0.35 0.14 0.04 0.08 0.93 0.24 0.2  0.02 0.35 0.01 0.46 1.   0.04\n",
      " 0.24 1.   1.   0.32 1.   0.61 0.05 0.01 0.91 1.   0.02 0.08 0.83 0.08\n",
      " 0.24 0.75 0.14 0.03 0.17 0.26 0.34 0.45 0.97 0.04 0.02 0.56 0.02 1.\n",
      " 0.22 0.31 0.32 0.99 0.35 1.   0.11 1.   0.58 0.23 0.1  0.18 0.04 0.1\n",
      " 0.1  0.12 0.07 0.04 0.68 0.08 0.09 0.38 0.16 0.06 0.01 0.38 0.15 0.09\n",
      " 0.01 1.   0.1  0.78 1.   0.5  0.09 0.93 1.   0.08 0.09 0.27 0.4  0.2\n",
      " 0.93 0.04 0.18 0.11 0.97 0.79 0.04 0.21 1.   0.23 0.18 0.34 0.   0.32\n",
      " 0.07 0.06 0.13 0.95 0.04 0.01 0.88 0.03 1.   0.03 0.39]\n"
     ]
    }
   ],
   "source": [
    "#Inserting the training DATA\n",
    "\n",
    "train_data = pd.read_csv(\"/kaggle/input/c/titanic/train.csv\")\n",
    "\n",
    "#Inserting the test \n",
    "\n",
    "test_data = pd.read_csv(\"/kaggle/input/c/titanic/test.csv\")\n",
    "#Predict\n",
    "\n",
    "y = train_data.Survived\n",
    "\n",
    "feature = ['PassengerId', 'Age', 'Fare', 'Cabin', 'Pclass', 'Embarked', 'Sex']\n",
    "\n",
    "#IMPORTANT: Cabin, Embarked, and sex are letter-type variables\n",
    "\n",
    "X = train_data[feature]\n",
    "\n",
    "#The Model (we will change it later for XGB or Randomforest)\n",
    "\n",
    "# from _ import _\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.ensemble import RandomForestRegressor\n",
    "from sklearn.metrics import mean_absolute_error\n",
    "from sklearn.preprocessing import OneHotEncoder\n",
    "from sklearn.ensemble import RandomForestClassifier\n",
    "\n",
    "#specify the model. \n",
    "#For model reproducibility, set a numeric value for random_state when specifying the model\n",
    "\n",
    "X_train, X_valid, y_train, y_valid = train_test_split(X, y, train_size=0.8, test_size=0.2,\n",
    "                                                      random_state=0)\n",
    "\n",
    "s = (X_train.dtypes == 'object')\n",
    "object_cols = list(s[s].index)\n",
    "\n",
    "def score_dataset(X_train, X_valid, y_train, y_valid):\n",
    "    model = RandomForestRegressor(n_estimators=100, random_state=0)\n",
    "    model.fit(X_train, y_train)\n",
    "    preds = model.predict(X_valid)\n",
    "    return mean_absolute_error(y_valid, preds)\n",
    "\n",
    "# Columns that will be one-hot encoded\n",
    "low_cardinality_cols = [col for col in object_cols if X_train[col].nunique() < 10]\n",
    "\n",
    "# Columns that will be dropped from the dataset\n",
    "high_cardinality_cols = list(set(object_cols)-set(low_cardinality_cols))\n",
    "\n",
    "print('Categorical columns that will be one-hot encoded:', low_cardinality_cols)\n",
    "print('\\nCategorical columns that will be dropped from the dataset:', high_cardinality_cols)\n",
    "\n",
    "# Apply one-hot encoder to each column with categorical data\n",
    "OH_encoder = OneHotEncoder(handle_unknown = 'ignore', sparse_output=False)\n",
    "OH_cols_train = pd.DataFrame(OH_encoder.fit_transform(X_train[object_cols]))\n",
    "OH_cols_valid = pd.DataFrame(OH_encoder.transform(X_valid[object_cols]))\n",
    "\n",
    "# One-hot encoding removed index; put it back\n",
    "OH_cols_train.index = X_train.index\n",
    "OH_cols_valid.index = X_valid.index\n",
    "\n",
    "# Remove categorical columns (will replace with one-hot encoding)\n",
    "num_X_train = X_train.drop(object_cols, axis=1)\n",
    "num_X_valid = X_valid.drop(object_cols, axis=1)\n",
    "\n",
    "# Add one-hot encoded columns to numerical features\n",
    "OH_X_train = pd.concat([num_X_train, OH_cols_train], axis=1)\n",
    "OH_X_valid = pd.concat([num_X_valid, OH_cols_valid], axis=1)\n",
    "\n",
    "# Ensure all columns have string type\n",
    "OH_X_train.columns = OH_X_train.columns.astype(str)\n",
    "OH_X_valid.columns = OH_X_valid.columns.astype(str)\n",
    "\n",
    "print(\"MAE from Approach 3 (One-Hot Encoding):\") \n",
    "print(score_dataset(OH_X_train, OH_X_valid, y_train, y_valid))\n",
    "#Check the predictions\n",
    "\n",
    "model = RandomForestRegressor(n_estimators=100, random_state=0)\n",
    "\n",
    "model.fit(OH_X_train, y_train)\n",
    "\n",
    "preds = model.predict(OH_X_valid)\n",
    "\n",
    "print(y_valid, preds)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "5b0a2fa7",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-22T17:06:21.762334Z",
     "iopub.status.busy": "2026-01-22T17:06:21.761785Z",
     "iopub.status.idle": "2026-01-22T17:06:21.793968Z",
     "shell.execute_reply": "2026-01-22T17:06:21.792946Z"
    },
    "papermill": {
     "duration": 0.03809,
     "end_time": "2026-01-22T17:06:21.795938",
     "exception": false,
     "start_time": "2026-01-22T17:06:21.757848",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>PassengerId</th>\n",
       "      <th>Survived</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>174</th>\n",
       "      <td>780</td>\n",
       "      <td>0.88</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>175</th>\n",
       "      <td>837</td>\n",
       "      <td>0.03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>176</th>\n",
       "      <td>215</td>\n",
       "      <td>1.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>177</th>\n",
       "      <td>833</td>\n",
       "      <td>0.03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>178</th>\n",
       "      <td>372</td>\n",
       "      <td>0.39</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "     PassengerId  Survived\n",
       "174          780      0.88\n",
       "175          837      0.03\n",
       "176          215      1.00\n",
       "177          833      0.03\n",
       "178          372      0.39"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "output = pd.DataFrame({'PassengerId': OH_X_valid.index,\n",
    "                       'Survived': preds})\n",
    "output.to_csv('submission.csv', index=False)\n",
    "\n",
    "output.tail()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "75a8ac82",
   "metadata": {
    "papermill": {
     "duration": 0.002202,
     "end_time": "2026-01-22T17:06:21.800456",
     "exception": false,
     "start_time": "2026-01-22T17:06:21.798254",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "### Checking the mean of the model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "88cfadbc",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-22T17:06:21.806650Z",
     "iopub.status.busy": "2026-01-22T17:06:21.806259Z",
     "iopub.status.idle": "2026-01-22T17:06:21.810739Z",
     "shell.execute_reply": "2026-01-22T17:06:21.809753Z"
    },
    "papermill": {
     "duration": 0.010372,
     "end_time": "2026-01-22T17:06:21.812928",
     "exception": false,
     "start_time": "2026-01-22T17:06:21.802556",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "#MAE with the Decission tree = 0.35955078278656283\n",
    "#MAE with the Random tree = 0.3516374852916999\n",
    "#MAE with the change in ramdom state to 1 = 0.38300989454695106\n",
    "#going back to ramdom state 2 = 0.344498959116622\n",
    "#Adding train size and all random states to 0 = 0.33185108932957624\n",
    "#More variables and hot Encoding = 0.21561135119490363\n",
    "#Adding PassengerID = 0.22307262569832403"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d1037520",
   "metadata": {
    "papermill": {
     "duration": 0.002818,
     "end_time": "2026-01-22T17:06:21.818212",
     "exception": false,
     "start_time": "2026-01-22T17:06:21.815394",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "#This doesn't work because of NaN variables\n",
    "\n",
    "\"model_1 = RandomForestRegressor(n_estimators=50, random_state=0)\n",
    "model_2 = RandomForestRegressor(n_estimators=100, random_state=0)\n",
    "model_3 = RandomForestRegressor(n_estimators=100, criterion='absolute_error', random_state=0)\n",
    "model_4 = RandomForestRegressor(n_estimators=200, min_samples_split=20, random_state=0)\n",
    "model_5 = RandomForestRegressor(n_estimators=100, max_depth=7, random_state=0)\n",
    "\n",
    "models = [model_1, model_2, model_3, model_4, model_5]\n",
    "\n",
    "def score_model(model, X_t=X_train, X_v=X_valid, y_t=y_train, y_v=y_valid):\n",
    "    model.fit(X_t, y_t)\n",
    "    preds = model.predict(X_v)\n",
    "    return mean_absolute_error(y_v, preds)\n",
    "\n",
    "for i in range(0, len(models)):\n",
    "    mae = score_model(models[i])\n",
    "    print(\"Model %d MAE: %d\" % (i+1, mae))"
   ]
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "none",
   "dataSources": [
    {
     "databundleVersionId": 26502,
     "isSourceIdPinned": false,
     "sourceId": 3136,
     "sourceType": "competition"
    }
   ],
   "dockerImageVersionId": 31259,
   "isGpuEnabled": false,
   "isInternetEnabled": false,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.12"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 9.617038,
   "end_time": "2026-01-22T17:06:22.542692",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2026-01-22T17:06:12.925654",
   "version": "2.6.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
